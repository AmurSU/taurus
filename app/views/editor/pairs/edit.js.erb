jQuery(document).ready(function($){
    $('body').prepend('<%= escape_javascript render :partial => 'pair_edit' %>');
    var dlg = $('#pair_edit_<%= escape_javascript @pair.id.to_s %>').dialog({
        beforeClose: function(event, ui) {
            $('#pair_edit_<%= escape_javascript @pair.id.to_s %>').remove();
        },
        closeText: 'Закрыть',
        draggable: false,
        modal: true,
        position: 'top',
        show: 'clip',
        hide: 'clip',
        title: 'Редактировать пару'
    });
    
    $('.edit_pair').submit(function() {
        dlg.dialog("close");
        return false;
    });
    
    $.getJSON('/editor/charge_cards.json', function(data) {
        var charge_cards = new Array(0);
        data.each(function(i) {
            charge_cards.push({ label: i.charge_card.name_for_pair_edit, value: i.charge_card.id });
        });

        $('.charge_card').autocomplete({
            source: charge_cards,
            select: function(event, ui) {
                $.post('/editor/pairs/' + '<%= escape_javascript @pair.id.to_s %>', {
                    charge_card_id: ui.item.value,
                    get_subgroups: true,
                    _method: 'put'},
                "script");
            }
        });
    });

    var months = [
        'Январь',
        'Февраль',
        'Март',
        'Апрель',
        'Май',
        'Июнь',
        'Июль',
        'Август',
        'Сентябрь',
        'Октябрь',
        'Ноябрь',
        'Декабрь'];
    $('#pair_active_at').datepicker({
        firstDay: 1,
        dateFormat: 'dd.mm.yy',
        monthNames: months,
        showOn: 'button',
        buttonImage: '/images/calendar.gif',
        buttonImageOnly: true
    });
    $('#pair_expired_at').datepicker({
        firstDay: 1,
        dateFormat: 'dd.mm.yy',
        monthNames: months,
        showOn: 'button',
        buttonImage: '/images/calendar.gif',
        buttonImageOnly: true
    });
    
});
