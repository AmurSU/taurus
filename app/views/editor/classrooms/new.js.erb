jQuery(document).ready(function($){
    $('#form').replaceWith('<%= escape_javascript render :partial => 'new' %>');
    $('#form').fadeIn('fast', function(){
        $('#classroom_name').focus();
    });    

    $('#classroom_name').autocomplete({
        disabled: false,
        source: function(request, response) {
            $.getJSON('/editor/classrooms.json', {
              classroom: request.term,
              except: '<%= escape_javascript @classrooms.join(',') %>'
            },
            function(data) {
                var classrooms = new Array(0);
                data.each(function(i) {
                    classrooms.push({ label: i.classroom.name + ' (' + i.classroom.building.name + ')', value: i.classroom.id });
                });
                response(classrooms);
            });
        },
        select: function(event, ui) {
          $.get('/editor/classrooms/' + ui.item.value, "script");
          return false;
        }
    });
});